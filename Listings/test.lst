


ARM Macro Assembler    Page 1 


    1 00000000         ;; RK - Evalbot (Cortex M3 de Texas Instrument)
    2 00000000         ;; Les deux LEDs sont initialement allumées
    3 00000000         ;; Ce programme lis l'état du bouton poussoir 1 connecté
                       e au port GPIOD broche 6
    4 00000000         ;; Si bouton poussoir fermé ==> fait clignoter les deux 
                       LED1&2 connectée au port GPIOF broches 4&5.
    5 00000000         
    6 00000000                 AREA             |.text|, CODE, READONLY
    7 00000000         
    8 00000000         ; This register controls the clock gating logic in norma
                       l Run mode
    9 00000000 400FE108 
                       SYSCTL_PERIPH_GPIO
                               EQU              0x400FE108  ; SYSCTL_RCGC2_R (p
                                                            291 datasheet de lm
                                                            3s9b92.pdf)
   10 00000000         
   11 00000000         ; The GPIODATA register is the data register
   12 00000000 40025000 
                       GPIO_PORTF_BASE
                               EQU              0x40025000  ; GPIO Port F (APB)
                                                             base: 0x4002.5000 
                                                            (p416 datasheet de 
                                                            lm3s9B92.pdf)
   13 00000000 40007000 
                       GPIO_PORTD_BASE
                               EQU              0x40007000  ; GPIO Port D (APB)
                                                             base: 0x4000.7000 
                                                            (p416 datasheet de 
                                                            lm3s9B92.pdf)
   14 00000000 40024000 
                       GPIO_PORTE_BASE
                               EQU              0x40024000  ; GPIO Port E (APB)
                                                             base: 0x4002.4000 
                                                            (p416 datasheet de 
                                                            lm3s9B92.pdf)
   15 00000000         
   16 00000000         ; configure the corresponding pin to be an output
   17 00000000         ; all GPIO pins are inputs by default
   18 00000000 00000400 
                       GPIO_O_DIR
                               EQU              0x00000400  ; GPIO Direction (p
                                                            417 datasheet de lm
                                                            3s9B92.pdf)
   19 00000000         
   20 00000000         ; The GPIODR2R register is the 2-mA drive control regist
                       er
   21 00000000         ; By default, all GPIO pins have 2-mA drive.
   22 00000000 00000500 
                       GPIO_O_DR2R
                               EQU              0x00000500  ; GPIO 2-mA Drive S
                                                            elect (p428 datashe
                                                            et de lm3s9B92.pdf)
                                                            
   23 00000000         
   24 00000000         ; Digital enable register
   25 00000000         ; To use the pin as a digital input or output, the corre
                       sponding GPIODEN bit must be set.
   26 00000000 0000051C 



ARM Macro Assembler    Page 2 


                       GPIO_O_DEN
                               EQU              0x0000051C  ; GPIO Digital Enab
                                                            le (p437 datasheet 
                                                            de lm3s9B92.pdf)
   27 00000000         
   28 00000000         ; Pul_up
   29 00000000 00000510 
                       GPIO_I_PUR
                               EQU              0x00000510  ; GPIO Pull-Up (p43
                                                            2 datasheet de lm3s
                                                            9B92.pdf)
   30 00000000         
   31 00000000         ; Broches select
   32 00000000 00000030 
                       BROCHE4_5
                               EQU              0x30        ; led1 & led2 sur b
                                                            roche 4 et 5
   33 00000000         
   34 00000000 00000010 
                       BROCHE4 EQU              0x10        ; led1 sur broche 4
                                                            
   35 00000000         
   36 00000000 00000020 
                       BROCHE5 EQU              0x20        ; led2 sur broche 5
                                                            
   37 00000000         
   38 00000000 000000C0 
                       BROCHE6_7
                               EQU              0xC0        ; bouton poussoir 1
                                                             et 2 sur broche 6 
                                                            et 7
   39 00000000         
   40 00000000 00000003 
                       BROCHE0_1
                               EQU              0x03        ; bumpers 1 et 2 su
                                                            r broche 0 et 1
   41 00000000         
   42 00000000         ; blinking frequency
   43 00000000 002FFFFF 
                       DUREE   EQU              0x002FFFFF
   44 00000000         
   45 00000000         
   46 00000000                 ENTRY
   47 00000000                 EXPORT           __main
   48 00000000         __main
   49 00000000         
   50 00000000         ; ;; Enable the Port F & D peripheral clock   (p291 data
                       sheet de lm3s9B96.pdf)
   51 00000000         ; ;;         
   52 00000000 4E29            ldr              r6, = SYSCTL_PERIPH_GPIO 
                                                            ;; RCGC2
   53 00000002 F04F 0038       mov              r0, #0x00000038 ;; Enable clock
                                                             sur GPIO D et F où
                                                             sont branchés les 
                                                            leds (0x28 == 0b111
                                                            000)
   54 00000006         ; ;;                              (GPIO::FEDCBA)
   55 00000006 6030            str              r0, [r6]
   56 00000008         



ARM Macro Assembler    Page 3 


   57 00000008         ; ;; "There must be a delay of 3 system clocks before an
                       y GPIO reg. access  (p413 datasheet de lm3s9B92.pdf)
   58 00000008 BF00            nop                          ;; tres tres import
                                                            ant....
   59 0000000A BF00            nop
   60 0000000C BF00            nop                          ;; pas necessaire e
                                                            n simu ou en debbug
                                                             step by step...
   61 0000000E         
   62 0000000E         
   63 0000000E         
   64 0000000E         
   65 0000000E         ;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^CONFIGURATION 2 LEDs
   66 0000000E         
   67 0000000E 4E27            ldr              r6, = GPIO_PORTF_BASE+GPIO_O_DI
R 
                                                            ;; 1 Pin du portF e
                                                            n sortie (broche 4 
                                                            : 00010000)
   68 00000010 F04F 0030       ldr              r0, = BROCHE4_5
   69 00000014 6030            str              r0, [r6]
   70 00000016         
   71 00000016 4E26            ldr              r6, = GPIO_PORTF_BASE+GPIO_O_DE
N 
                                                            ;; Enable Digital F
                                                            unction 
   72 00000018 F04F 0030       ldr              r0, = BROCHE4_5
   73 0000001C 6030            str              r0, [r6]
   74 0000001E         
   75 0000001E 4E25            ldr              r6, = GPIO_PORTF_BASE+GPIO_O_DR
2R 
                                                            ;; Choix de l'inten
                                                            sité de sortie (2mA
                                                            )
   76 00000020 F04F 0030       ldr              r0, = BROCHE4_5
   77 00000024 6030            str              r0, [r6]
   78 00000026         
   79 00000026 F04F 0200       mov              r2, #0x000  ;; pour eteindre LE
                                                            D
   80 0000002A         
   81 0000002A         ; allumer la led broche 4 (BROCHE4_5)
   82 0000002A F04F 0330       mov              r3, #BROCHE4_5 ;; Allume LED1&2
                                                             portF broche 4&5 :
                                                             00110000
   83 0000002E         
   84 0000002E 4E22            ldr              r6, = GPIO_PORTF_BASE + (BROCHE
4_5<<2) 
                                                            ;; @data Register =
                                                             @base + (mask<<2) 
                                                            ==> LED1
   85 00000030         
   86 00000030         ;vvvvvvvvvvvvvvvvvvvvvvvFin configuration LED 
   87 00000030         
   88 00000030         
   89 00000030         
   90 00000030         ;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^CONFIGURATION Switcher 
   91 00000030         
   92 00000030 4F22            ldr              r7, = GPIO_PORTD_BASE+GPIO_I_PU
R 



ARM Macro Assembler    Page 4 


                                                            ;; Pul_up 
   93 00000032 F04F 00C0       ldr              r0, = BROCHE6_7
   94 00000036 6038            str              r0, [r7]
   95 00000038         
   96 00000038 4F21            ldr              r7, = GPIO_PORTD_BASE+GPIO_O_DE
N 
                                                            ;; Enable Digital F
                                                            unction 
   97 0000003A F04F 00C0       ldr              r0, = BROCHE6_7
   98 0000003E 6038            str              r0, [r7]
   99 00000040         
  100 00000040 4F20            ldr              r7, = GPIO_PORTD_BASE + (BROCHE
6_7<<2) 
                                                            ;; @data Register =
                                                             @base + (mask<<2) 
                                                            ==> Switcher
  101 00000042         
  102 00000042         ;vvvvvvvvvvvvvvvvvvvvvvvFin configuration Switcher
  103 00000042         
  104 00000042         
  105 00000042         
  106 00000042         ;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^CONFIGURATION Bumper 
  107 00000042         
  108 00000042 F8DF 8084       ldr              r8, = GPIO_PORTE_BASE+GPIO_I_PU
R 
                                                            ;; Pul_up 
  109 00000046 F04F 0003       ldr              r0, = BROCHE0_1
  110 0000004A F8C8 0000       str              r0, [r8]
  111 0000004E         
  112 0000004E F8DF 807C       ldr              r8, = GPIO_PORTE_BASE+GPIO_O_DE
N 
                                                            ;; Enable Digital F
                                                            unction 
  113 00000052 F04F 0003       ldr              r0, = BROCHE0_1
  114 00000056 F8C8 0000       str              r0, [r8]
  115 0000005A         
  116 0000005A F8DF 8074       ldr              r8, = GPIO_PORTE_BASE + (BROCHE
0_1<<2) 
                                                            ;; @data Register =
                                                             @base + (mask<<2) 
                                                            ==> Bumper
  117 0000005E         
  118 0000005E         ;vvvvvvvvvvvvvvvvvvvvvvvFin configuration Bumper 
  119 0000005E         
  120 0000005E E015            B                CheckBumpers
  121 00000060         
  122 00000060         TurnOnLeds
  123 00000060 4E15            ldr              r6, = GPIO_PORTF_BASE + (BROCHE
4_5<<2)
  124 00000062 F04F 0330       ldr              r3, = BROCHE4_5
  125 00000066 6033            str              r3, [r6]
  126 00000068 E010            B                CheckBumpers
  127 0000006A         
  128 0000006A         TurnOnLed1
  129 0000006A 4E1A            ldr              r6, = GPIO_PORTF_BASE + (BROCHE
5<<2)
  130 0000006C 6032            str              r2, [r6]    ; Turns off Led 2
  131 0000006E 4E1A            ldr              r6, = GPIO_PORTF_BASE + (BROCHE
4<<2)



ARM Macro Assembler    Page 5 


  132 00000070 F04F 0310       ldr              r3, = BROCHE4 ; Turns on Led 1
  133 00000074 6033            str              r3, [r6]
  134 00000076 E009            B                CheckBumpers
  135 00000078         
  136 00000078         TurnOnLed2
  137 00000078 4E17            ldr              r6, = GPIO_PORTF_BASE + (BROCHE
4<<2)
  138 0000007A 6032            str              r2, [r6]    ; Turns off Led 1
  139 0000007C 4E15            ldr              r6, = GPIO_PORTF_BASE + (BROCHE
5<<2)
  140 0000007E F04F 0320       ldr              r3, = BROCHE5
  141 00000082 6033            str              r3, [r6]
  142 00000084 E002            B                CheckBumpers
  143 00000086         
  144 00000086         TurnOffLeds
  145 00000086 4E0C            ldr              r6, = GPIO_PORTF_BASE + (BROCHE
4_5<<2)
  146 00000088 6032            str              r2, [r6]
  147 0000008A E7FF            B                CheckBumpers
  148 0000008C         
  149 0000008C         CheckBumpers
  150 0000008C F8D8 A000       ldr              r10, [r8]
  151 00000090 F1BA 0F00       CMP              r10, #0x00  ; Check if both are
                                                             pushed
  152 00000094 D0E4            BEQ              TurnOnLeds
  153 00000096 F1BA 0F02       CMP              r10, #0x02  ; Check if left one
                                                             is pushed
  154 0000009A D0E6            BEQ              TurnOnLed1
  155 0000009C F1BA 0F01       CMP              r10, #0x01  ; check if right on
                                                            e is pushed
  156 000000A0 D0EA            BEQ              TurnOnLed2
  157 000000A2         
  158 000000A2 E7F0            B                TurnOffLeds ; if none, turn off
                                                             leds
  159 000000A4         
  160 000000A4         
  161 000000A4 BF00            nop
  162 000000A6                 END
              00 00 400FE108 
              40025400 
              4002551C 
              40025500 
              400250C0 
              40007510 
              4000751C 
              40007300 
              40024510 
              4002451C 
              4002400C 
              40025080 
              40025040 
Command Line: --debug --xref --diag_suppress=9931 --cpu=Cortex-M3 --apcs=interw
ork --depend=.\objects\test.d -o.\objects\test.o -I.\RTE\_Target_1 -IC:\Users\f
oulo\AppData\Local\Arm\Packs\ARM\CMSIS\5.9.0\CMSIS\Core\Include -IC:\Users\foul
o\AppData\Local\Arm\Packs\ARM\CMSIS\5.9.0\Device\ARM\ARMCM3\Include --predefine
="__EVAL SETA 1" --predefine="__MICROLIB SETA 1" --predefine="__UVISION_VERSION
 SETA 528" --predefine="_RTE_ SETA 1" --predefine="ARMCM3 SETA 1" --list=.\list
ings\test.lst test.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

.text 00000000

Symbol: .text
   Definitions
      At line 6 in file test.s
   Uses
      None
Comment: .text unused
CheckBumpers 0000008C

Symbol: CheckBumpers
   Definitions
      At line 149 in file test.s
   Uses
      At line 120 in file test.s
      At line 126 in file test.s
      At line 134 in file test.s
      At line 142 in file test.s
      At line 147 in file test.s

TurnOffLeds 00000086

Symbol: TurnOffLeds
   Definitions
      At line 144 in file test.s
   Uses
      At line 158 in file test.s
Comment: TurnOffLeds used once
TurnOnLed1 0000006A

Symbol: TurnOnLed1
   Definitions
      At line 128 in file test.s
   Uses
      At line 154 in file test.s
Comment: TurnOnLed1 used once
TurnOnLed2 00000078

Symbol: TurnOnLed2
   Definitions
      At line 136 in file test.s
   Uses
      At line 156 in file test.s
Comment: TurnOnLed2 used once
TurnOnLeds 00000060

Symbol: TurnOnLeds
   Definitions
      At line 122 in file test.s
   Uses
      At line 152 in file test.s
Comment: TurnOnLeds used once
__main 00000000

Symbol: __main
   Definitions
      At line 48 in file test.s
   Uses
      At line 47 in file test.s



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

Comment: __main used once
7 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

BROCHE0_1 00000003

Symbol: BROCHE0_1
   Definitions
      At line 40 in file test.s
   Uses
      At line 109 in file test.s
      At line 113 in file test.s
      At line 116 in file test.s

BROCHE4 00000010

Symbol: BROCHE4
   Definitions
      At line 34 in file test.s
   Uses
      At line 131 in file test.s
      At line 132 in file test.s
      At line 137 in file test.s

BROCHE4_5 00000030

Symbol: BROCHE4_5
   Definitions
      At line 32 in file test.s
   Uses
      At line 68 in file test.s
      At line 72 in file test.s
      At line 76 in file test.s
      At line 82 in file test.s
      At line 84 in file test.s
      At line 123 in file test.s
      At line 124 in file test.s
      At line 145 in file test.s

BROCHE5 00000020

Symbol: BROCHE5
   Definitions
      At line 36 in file test.s
   Uses
      At line 129 in file test.s
      At line 139 in file test.s
      At line 140 in file test.s

BROCHE6_7 000000C0

Symbol: BROCHE6_7
   Definitions
      At line 38 in file test.s
   Uses
      At line 93 in file test.s
      At line 97 in file test.s
      At line 100 in file test.s

DUREE 002FFFFF

Symbol: DUREE
   Definitions



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Absolute symbols

      At line 43 in file test.s
   Uses
      None
Comment: DUREE unused
GPIO_I_PUR 00000510

Symbol: GPIO_I_PUR
   Definitions
      At line 29 in file test.s
   Uses
      At line 92 in file test.s
      At line 108 in file test.s

GPIO_O_DEN 0000051C

Symbol: GPIO_O_DEN
   Definitions
      At line 26 in file test.s
   Uses
      At line 71 in file test.s
      At line 96 in file test.s
      At line 112 in file test.s

GPIO_O_DIR 00000400

Symbol: GPIO_O_DIR
   Definitions
      At line 18 in file test.s
   Uses
      At line 67 in file test.s
Comment: GPIO_O_DIR used once
GPIO_O_DR2R 00000500

Symbol: GPIO_O_DR2R
   Definitions
      At line 22 in file test.s
   Uses
      At line 75 in file test.s
Comment: GPIO_O_DR2R used once
GPIO_PORTD_BASE 40007000

Symbol: GPIO_PORTD_BASE
   Definitions
      At line 13 in file test.s
   Uses
      At line 92 in file test.s
      At line 96 in file test.s
      At line 100 in file test.s

GPIO_PORTE_BASE 40024000

Symbol: GPIO_PORTE_BASE
   Definitions
      At line 14 in file test.s
   Uses
      At line 108 in file test.s
      At line 112 in file test.s
      At line 116 in file test.s




ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Absolute symbols

GPIO_PORTF_BASE 40025000

Symbol: GPIO_PORTF_BASE
   Definitions
      At line 12 in file test.s
   Uses
      At line 67 in file test.s
      At line 71 in file test.s
      At line 75 in file test.s
      At line 84 in file test.s
      At line 123 in file test.s
      At line 129 in file test.s
      At line 131 in file test.s
      At line 137 in file test.s
      At line 139 in file test.s
      At line 145 in file test.s

SYSCTL_PERIPH_GPIO 400FE108

Symbol: SYSCTL_PERIPH_GPIO
   Definitions
      At line 9 in file test.s
   Uses
      At line 52 in file test.s
Comment: SYSCTL_PERIPH_GPIO used once
14 symbols
358 symbols in table
